<!DOCTYPE html>
<html data-theme="light" lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="{{ .Permalink }}">

    {{/* Bulma précompilé (copié depuis node_modules/bulma/css vers static/) */}}
    <link rel="preload" as="style" href="/bulma.min.css">
    <link rel="stylesheet" href="/bulma.min.css">

    {{/* Ton CSS applicatif */}}
    {{ $app := resources.Get "styles.css" | resources.Minify | resources.Fingerprint }}
    <link rel="preload" as="style" href="{{ $app.RelPermalink }}">
    <link rel="stylesheet" href="{{ $app.RelPermalink }}" integrity="{{ $app.Data.Integrity }}">

    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />

    {{/* -------- SEO: Title + Description dynamiques -------- */}}
    {{ $defaultDesc := "Massages bien-être à Villeneuve-sur-Lot : Aromatouch, Amma assis, Rebozo, Massage femme enceinte, Thérapie Sipho. Réservation et infos tarifs." }}
    {{ $desc := cond (ne (or .Description "") "") .Description $defaultDesc }}

    <title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}</title>
    <meta name="description" content="{{ $desc }}">

    {{/* OpenGraph */}}
    <meta property="og:type" content="website">
    <meta property="og:locale" content="fr_FR">
    <meta property="og:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}">
    <meta property="og:description" content="{{ $desc }}">
    <meta property="og:url" content="{{ .Permalink }}">
    {{ with .Site.Params.ogImage }}<meta property="og:image" content="{{ . }}">{{ end }}

    {{/* Twitter Card */}}
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}">
    <meta name="twitter:description" content="{{ $desc }}">
    {{ with .Site.Params.ogImage }}<meta name="twitter:image" content="{{ . }}">{{ end }}
  </head>
  <body class="has-navbar-fixed-top">
    {{ partial "navbar.html" . }}
    {{ block "main" . }}
      <!-- The part of the page that begins to differ between templates -->
    {{ end }}
    {{ partial "footer.html" . }}

    {{/* -------- JSON-LD : LocalBusiness (global, une seule fois) -------- */}}
    <script type="application/ld+json">
    {
      "@context":"https://schema.org",
      "@type":"HealthAndBeautyBusiness",
      "name":"{{ .Site.Params.business_name }}",
      "url":"{{ .Site.BaseURL }}",
      "image":"{{ .Site.BaseURL }}logo.png",
      "email":"{{ .Site.Params.email }}",
      "telephone":"{{ .Site.Params.phone }}",
      "priceRange":"{{ .Site.Params.priceRange }}",
      "identifier": "{{ .Site.Params.siret }}",
      "address":{
        "@type":"PostalAddress",
        "streetAddress":"{{ .Site.Params.streetAddress }}",
        "addressLocality":"{{ .Site.Params.city }}",
        "postalCode":"{{ .Site.Params.postalCode }}",
        "addressCountry":"{{ .Site.Params.country }}"
      },
      "geo":{
        "@type":"GeoCoordinates",
        "latitude": {{ .Site.Params.geo.lat }},
        "longitude": {{ .Site.Params.geo.lng }}
      }
    }
    </script>

    <script defer>
      // Minimal Bulma burger
      document.addEventListener('DOMContentLoaded', () => {
        const burgers = Array.from(document.querySelectorAll('.navbar-burger'));
        burgers.forEach(b => {
          b.addEventListener('click', () => {
            const target = b.dataset.target;
            const menu = document.getElementById(target);
            b.classList.toggle('is-active');
            menu?.classList.toggle('is-active');
          });
        });
      });
    </script>
    <script>
      // Caler la variable CSS --nav-h sur la hauteur réelle de la navbar (desktop/mobile)
      function updateNavHeight() {
        const nav = document.querySelector('.navbar');
        if (!nav) return;
        document.documentElement.style.setProperty('--nav-h', nav.offsetHeight + 'px');
      }
      window.addEventListener('load', updateNavHeight);
      window.addEventListener('resize', updateNavHeight);
    </script>

  </body>
</html>
